<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>视频动作相似度比较</title>
    <link rel="stylesheet" href="./css/styles.css" />
    <link rel="icon" href="./res/icon48.png" type="image/png" />
  </head>
  <body>
    <div style="flex: 1">
      <div class="comparison-container">
        <!-- 参考视频 -->
        <div class="video-section" id="referenceVideoSection">
          <div class="progress-container">
            <span class="time-display" id="referenceCurrentTime">00:00</span>
            <input
              type="range"
              id="referenceProgressBar"
              class="progress-bar"
              value="0"
              min="0"
              max="100"
            />
            <span class="time-display" id="referenceTotalTime">00:00</span>
          </div>
          <div class="video-wrapper">
            <video id="referenceVideo" playsinline></video>
            <canvas id="referenceCanvas"></canvas>
          </div>
          <div class="controls-group">
            <button id="referencePlayButton" disabled>播放</button>
            <button id="referencePauseButton" disabled>暂停</button>
            <!-- <button id="referenceAnalyzeButton" disabled>开始分析</button> -->
          </div>
          <div class="angle-data">
            <h4>关键点角度数据</h4>
            <div id="referenceAngleData">等待分析...</div>
          </div>
          <div class="file-input-group">
            <input type="file" id="referenceFileInput" accept="video/*, .flv" />
            <button id="loadReferenceButton">加载参考视频</button>
            <button id="loadReferenceExampleButton">加载示例视频</button>
          </div>
        </div>

        <!-- 对比视频 -->
        <div class="video-section" id="targetVideoSection">
          <div class="progress-container">
            <span class="time-display" id="targetCurrentTime">00:00</span>
            <input
              type="range"
              id="targetProgressBar"
              class="progress-bar"
              value="0"
              min="0"
              max="100"
            />
            <span class="time-display" id="targetTotalTime">00:00</span>
          </div>

          <div class="video-wrapper">
            <video id="targetVideo" playsinline muted></video>
            <canvas id="targetCanvas"></canvas>
          </div>
          <div class="controls-group">
            <button id="targetPlayButton" disabled>播放</button>
            <button id="targetPauseButton" disabled>暂停</button>
            <!-- <button id="targetAnalyzeButton" disabled>开始分析</button> -->
          </div>
          <div class="angle-data">
            <h4>关键点角度数据</h4>
            <div id="targetAngleData">等待分析...</div>
          </div>
          <div class="file-input-group">
            <input type="file" id="targetFileInput" accept="video/*, .flv" />
            <button id="loadTargetButton">加载对比视频</button>
            <button id="loadTargetExampleButton">加载示例视频</button>
            <button id="useCameraButton">使用摄像头</button>
            <button id="stopCameraButton" disabled>停止摄像头</button>
          </div>
        </div>

        <!-- 相似度结果 -->
      </div>
    </div>

    <div id="dataPanel">
      <div class="similarity-container">
        <!-- 添加上半身、下半身和窗口相似度显示 -->
        <!-- 新增：显示总分 -->
        <div class="similarity-item" id="totalScoreDisplay">
          <h1 class="similarity-label">总分:</h1>
          <h1 class="similarity-value" id="totalScoreValue">???.??</h1>
        </div>
        <div class="detailed-similarity">
          <h3>详细相似度分析</h3>

          <div class="similarity-item">
            <span class="similarity-label">上半身瞬间相似度:</span>
            <span class="similarity-value" id="upperBodyInstantSimilarity"
              >--%</span
            >
          </div>
          <div class="similarity-item">
            <span class="similarity-label">下半身瞬间相似度:</span>
            <span class="similarity-value" id="lowerBodyInstantSimilarity"
              >--%</span
            >
          </div>
          <div class="similarity-item">
            <span class="similarity-label">窗口相似度:</span>
            <span class="similarity-value" id="windowSimilarity">--%</span>
          </div>
        </div>

        <div id="similarityStatus">请加载两个视频并开始分析</div>
        <div class="controls-group">
          <button id="startComparisonButton" disabled>开始比较</button>
          <button id="stopComparisonButton" disabled>停止比较</button>
          <button id="startGameButton">开始游戏</button>
        </div>

        <!-- 添加BPM输入框 -->
        <div class="controls-group">
          <label for="bpmInput">BPM:</label>
          <input type="number" id="bpmInput" min="30" max="300" value="120" />
        </div>

        <div class="angle-data">
          <h4>角度差异对比</h4>
          <div id="comparisonAngleData">等待比较...</div>
        </div>

        <!-- <div class="angle-data">
                    <h4>各肢体相似度</h4>
                    <div id="limbSimilarityData">等待比较...</div>
                </div> -->
      </div>
      <div id="keypointsComparison" class="panel-section">
        <h3>关键点对比数据</h3>
        <div id="comparisonData"></div>
      </div>
    </div>

    <!-- 添加游戏模式容器 -->
    <div id="gameModeContainer">
      <video id="gameReferenceVideo" playsinline></video>
      <div id="gameTargetVideoContainer">
        <video id="gameTargetVideo" playsinline muted></video>
      </div>
      <div id="gameScoreContainer">分数: <span id="gameScore">0.00</span></div>
      <div id="gameWindowSimilarity">
        <span id="currentWindowSimilarity">--</span>%
      </div>
      <button id="exitGameButton">退出游戏</button>
      <div
        id="countdown"
        style="
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          font-size: 100px;
          color: white;
          display: none;
        "
      ></div>
    </div>

    <script src="./models/tf.min.js"></script>
    <script src="./models/pose-detection.min.js"></script>
    <script src="./js/motion.js">

    </script>
  </body>
</html>
